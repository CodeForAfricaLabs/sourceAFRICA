dc.ui.AdminAccounts=Backbone.View.extend({DISABLED:0,ADMINISTRATOR:1,CONTRIBUTOR:2,REVIEWER:3,FREELANCER:4,render:function(){$(this.el).html(JST.admin_accounts({}));var a=Accounts.map(function(a){return(new dc.ui.AccountView({model:a,kind:"admin"})).render().el});this.$("tbody").append(a);return this},isAdmin:function(){return this.get("role")==this.ADMINISTRATOR}});
dc.ui.Admin=Backbone.View.extend({GRAPH_OPTIONS:{xaxis:{mode:"time",minTickSize:[1,"day"]},yaxis:{},legend:{show:!1},series:{lines:{show:!0,fill:!1},points:{show:!1}},grid:{borderWidth:1,borderColor:"#222",labelMargin:7,hoverable:!0}},DATE_TRIPLETS:/(\d+)(\d{3})/,DATE_FORMAT:"%b %d, %y",INSTANCE_TAGS:{"i-0d4e9065":"staging","i-a3466ecb":"app01","i-4752792f":"db01","i-c47d78b9":"worker01","i-c41216b9":"worker02","i-c61216bb":"worker03","i-c01216bd":"worker04"},id:"statistics",className:"serif",events:{"plothover .chart":"_showTooltop",
"click #instances .minus":"_terminateInstance","click .more_top_documents":"_loadMoreTopDocuments","click #load_all_accounts":"_loadAllAccounts","click .account_list .sort":"_sortAccounts"},ACCOUNT_COMPARATORS:{name:dc.model.AccountSet.prototype.comparator,email:function(a){return a.get("email").toLowerCase()},organization:function(a){return a.get("orgnization_name").toLowerCase()},document_count:function(a){return-(a.get("public_document_count")||0+a.get("private_document_count")||0)},page_count:function(a){return-a.get("page_count")||
0}},initialize:function(a){_.bindAll(this,"renderCharts","launchWorker","reprocessFailedDocument","vacuumAnalyze","optimizeSolr","_loadAllAccounts");this._tooltip=new dc.ui.Tooltip;this._actionsMenu=this._createActionsMenu();$(window).bind("resize",this.renderCharts)},render:function(){$(this.el).html(JST.statistics(this.data()));$("#topbar").append(this._actionsMenu.render().el);_.defer(this.renderCharts);Accounts.length&&_.defer(this._loadAllAccounts);return this},renderCharts:function(){this.$(".chart").html("");
$.plot($("#daily_docs_chart"),[this._series(stats.daily_documents,"Document",1),this._series(stats.daily_pages,"Page",2)],this.GRAPH_OPTIONS);$.plot($("#weekly_docs_chart"),[this._series(stats.weekly_documents,"Document",1),this._series(stats.weekly_pages,"Page",2)],this.GRAPH_OPTIONS);$.plot($("#daily_hits_chart"),[this._series(stats.daily_hits_on_documents,"Document Hit"),this._series(stats.daily_hits_on_notes,"Note Hit"),this._series(stats.daily_hits_on_searches,"Search Hit")],this.GRAPH_OPTIONS);
$.plot($("#weekly_hits_chart"),[this._series(stats.weekly_hits_on_documents,"Document Hit"),this._series(stats.weekly_hits_on_notes,"Note Hit"),this._series(stats.weekly_hits_on_searches,"Search Hit")],this.GRAPH_OPTIONS)},_series:function(a,b,c){return{title:b,yaxis:c,color:1==c?"#7EC6FE":"#199aff",data:_.sortBy(_.map(a,function(a,b){return[1E3*parseInt(b,10),a]}),function(a){return a[0]})}},renderAccounts:function(){this.$("#accounts_wrapper").html((new dc.ui.AdminAccounts).render().el)},data:function(){var a=
stats.documents_by_access,b=dc.access;return{total_documents:this._format(this.totalDocuments()),embedded_documents:this._format(stats.embedded_documents),total_pages:this._format(stats.total_pages),average_page_count:this._format(stats.average_page_count),public_docs:this._format(a[b.PUBLIC]||0),private_docs:this._format((a[b.PRIVATE]||0)+(a[b.ORGANIZATION]||0)+(a[b.EXCLUSIVE]||0)),pending_docs:this._format(a[b.PENDING]||0),error_docs:this._format(a[b.ERROR]||0),instance_tags:this.INSTANCE_TAGS,
remote_url_hits_last_week:this._format(stats.remote_url_hits_last_week),remote_url_hits_all_time:this._format(stats.remote_url_hits_all_time),count_organizations_embedding:this._format(stats.count_organizations_embedding),count_total_collaborators:this._format(stats.count_total_collaborators)}},totalDocuments:function(){return _.reduce(stats.documents_by_access,function(a,b){return a+b},0)},launchWorker:function(){dc.ui.Dialog.confirm("Are you sure you want to launch a new Medium Compute<br />      EC2 instance for document processing, on <b>production</b>?",
function(){$.post("/admin/launch_worker",function(){dc.ui.Dialog.alert("The worker instance has been launched successfully.          It will be a few minutes before it comes online and registers with CloudCrowd.")});return!0})},vacuumAnalyze:function(){$.post("/admin/vacuum_analyze",function(){dc.ui.Dialog.alert("The vacuum background job was started successfully.")})},optimizeSolr:function(){$.post("/admin/optimize_solr",function(){dc.ui.Dialog.alert("The Solr optimization task was started successfully.")})},
forceBackup:function(){$.post("/admin/force_backup",function(){dc.ui.Dialog.alert("The database backup job was started successfully.")})},reprocessFailedDocument:function(){dc.ui.Dialog.confirm("Are you sure you want to re-import the last failed document?",function(){$.post("/admin/reprocess_failed_document",function(){window.location.reload(!0)});return!0})},_terminateInstance:function(a){var b=$(a.target).attr("data-id");dc.ui.Dialog.confirm("Are you sure you want to terminate instance <b>"+b+"</b>?",
function(){$.post("/admin/terminate_instance",{instance:b},function(){dc.ui.Dialog.alert("Instance <b>"+b+"</b> is shutting down.")});return!0})},_sortAccounts:function(a){a=$(a.target).attr("data-sort");Accounts.comparator=this.ACCOUNT_COMPARATORS[a];Accounts.sort();this.renderAccounts();$(".account_list .sort_"+a).addClass("active")},_showTooltop:function(a,b,c){if(!c)return this._tooltip.hide();a=c.datapoint[1];var d=$.plot.formatDate(new Date(c.datapoint[0]),this.DATE_FORMAT);c=dc.inflector.pluralize(c.series.title,
a);this._tooltip.show({left:b.pageX,top:b.pageY,title:a+" "+c,text:d})},_loadAllAccounts:function(){$("#load_all_accounts").hide();$(".minibutton.download_csv").hide();var a=_.bind(function(){this.renderAccounts();this._addCountsToAccounts();$("tr.accounts_row").show()},this);if(Accounts.length)return a();$.getJSON("/admin/all_accounts",{},_.bind(function(b){Accounts.reset(b.accounts);delete b.accounts;_.extend(stats,b);a()},this))},_loadMoreTopDocuments:function(a){$.getJSON("/admin/hits_on_documents",
{},_.bind(this._displayMoreTopDocuments,this))},_displayMoreTopDocuments:function(a){TopDocuments.reset(a);this.$(".top_documents_list").replaceWith(JST.top_documents({}));this.$(".top_documents_label_year").css({display:"table-row"});this.$(".top_documents_label_week").css({display:"none"})},_format:function(a){var b=(a+"").split(".");a=b[0];for(b=1<b.length?"."+b[1]:"";this.DATE_TRIPLETS.test(a);)a=a.replace(this.DATE_TRIPLETS,"$1,$2");return a+b},_createActionsMenu:function(){return new dc.ui.Menu({label:"Administrative Actions",
id:"admin_actions",items:[{title:"Update Dashboard Stats",onClick:function(){window.location="/admin/expire_stats"}},{title:"Add an Organization",onClick:function(){window.location="/admin/signup"}},{title:"View CloudCrowd Console",onClick:function(){window.location=CLOUD_CROWD_SERVER}},{title:"Reprocess Last Failed Doc",onClick:this.reprocessFailedDocument},{title:"Force a DB Backup to S3",onClick:this.forceBackup},{title:"Vacuum Analyze the DB",onClick:this.vacuumAnalyze},{title:"Optimize the Solr Index",
onClick:this.optimizeSolr},{title:"Launch a Worker Instance",onClick:this.launchWorker},{title:"Edit Featured Reporting",onClick:function(){window.location="/admin/featured"}}]})},_addCountsToAccounts:function(){Accounts.each(function(a){a.set({public_document_count:stats.public_per_account[a.id],private_document_count:stats.private_per_account[a.id],page_count:stats.pages_per_account[a.id]})})}});
dc.ui.FeaturedReport=Backbone.View.extend({attributes:{"class":"report"},events:{"click .ok":"save","click .edit_glyph":"edit","click .cancel":"cancel","click .delete":"deleteReport"},initialize:function(a){_.bindAll(this,"_onError","_onSuccess")},renderTmpl:function(a){a=a?JST.featured_report_edit:JST.featured_report_display;var b=this.model.toJSON();this.$el.html(a(b)).attr("data-id",this.model.id)},render:function(){this.renderTmpl(this.model.isNew());return this},cancel:function(){this.model.isNew()?
this.model.collection.remove(this.model):this.render()},deleteReport:function(){this.model.destroy({success:function(a,b){a.collection.remove(a)}})},edit:function(){this.renderTmpl(!0)},_onSuccess:function(a,b){this.render();dc.ui.spinner.hide()},_onError:function(a,b){b=JSON.parse(b.responseText);b.errors&&this.$(".errors").html("The following errors were encountered:<ul>"+_.reduce(b.errors,function(a,b){return a+"<li>"+b+"</li>"},"")+"</ul>");dc.ui.spinner.hide()},save:function(){dc.ui.spinner.show("Saving");
this.model.save(this.$("form.edit").serializeJSON(),{error:this._onError,success:this._onSuccess})}});
dc.ui.FeaturedReporting=Backbone.View.extend({attributes:{"class":"featured_reports"},events:{"click .toAdmin":"visitAdmin","click .reload":"reload","click .add":"addReport"},initialize:function(a){_.bindAll(this,"appendReport","prependReport","render","saveSortOrder");this.collection.bind("reset",this.render);this.collection.bind("add",this.prependReport);this.collection.bind("remove",this.render)},saveSortOrder:function(){var a=_.map(this.$(".listing .report[data-id]"),function(a){return a.getAttribute("data-id")});
$.ajax(this.collection.url+"/present_order",{data:{order:a}})},addReport:function(){this.collection.add({})},prependReport:function(a){a=new dc.ui.FeaturedReport({model:a});this.$(".listing").prepend(a.render().el)},appendReport:function(a){a=new dc.ui.FeaturedReport({model:a});this.$(".listing").append(a.render().el)},render:function(){this.$el.html(JST.featured_reporting({}));this.collection.each(this.appendReport);this.$(".listing").sortable({placeholder:"drop-placeholder",forcePlaceholderSize:!0,
stop:this.saveSortOrder});return this},reload:function(){this.collection.fetch()},visitAdmin:function(){window.location="/admin/"}});
(function(){window.JST=window.JST||{};window.JST.admin_accounts=_.template('<table class="account_list">\n  <thead>\n    <td></td>\n    <td><span class="sort sort_name" data-sort="name">Name</span></td>\n    <td><span class="sort sort_email" data-sort="email">Email</span></td>\n    <td><span class="sort sort_organization" data-sort="organization">Organization</span></td>\n    <td><span class="sort sort_document_count" data-sort="document_count">Documents</span></td>\n    <td><span class="sort sort_page_count" data-sort="page_count">Pages</span></td>\n    <td></td>\n    <td></td>\n  </thead>\n  <tbody>\n    \n  </tbody>\n</table>');window.JST.featured_report_display=
_.template('  <div class="controls">\n    <div class="icon edit_glyph">&#65279;</div>\n  </div>\n  <h6>\n    <a href="<%= url %>"><u><%= title %></u></a>\n    <small><i><%= organization %></i>, <%= article_date %></small>\n  </h6>\n  <%= writeup_html %>\n');window.JST.featured_report_edit=_.template('<form class="edit">\n  <div class="errors"></div>\n  <div class="row">\n    <div class="title">\n      <label for="title" title="What is the name of the Article?">\n        Title\n      </label>\n      <div class="text_input small">\n        <input name="title" id="title" class="attribute" type="text" value="<%= title %>" />\n      </div>\n    </div>\n\n    <div class="url">\n      <label for="url" title="Link to the article">\n        URL\n      </label>\n      <div class="text_input small">\n        <input name="url" id="url" class="attribute" type="text" value="<%= url %>" />\n      </div>\n    </div>\n    <br class="clear"/>\n  </div>\n\n\n  <div class="row">\n    <div class="organization">\n      <label for="organization" title="Organization that created Article">\n        Organization\n      </label>\n      <div class="text_input small">\n        <input name="organization" id="organization" class="attribute" type="text" value="<%= organization %>" />\n      </div>\n    </div>\n\n    <div class="article_date">\n      <label for="article_date" title="Date Article was created/posted">\n        Article Date <i>(YYYY-MM-DD)</i>\n      </label>\n      <div class="text_input small">\n        <input name="article_date" id="article_date" class="attribute" type="text" value="<%= article_date %>" />\n      </div>\n    </div>\n    <br class="clear"/>\n  </div>\n  \n  <div class="row writeup">\n    <label for="writeup" title="Description of Article">\n      Writeup <i>(in <a href="http://daringfireball.net/projects/markdown/basics" target="_blank">Markdown format</a>)</i>\n    </label>\n    <textarea name="writeup" id="writeup" class="text_area" type="text"><%= writeup %></textarea>\n  </div>\n\n  <div class="minibutton warn delete" href="#">Delete</div>\n  <div class="controls">\n    <div class="minibutton cancel" href="#">Cancel</div>\n    <div class="minibutton ok" href="#">Save</div>  \n  </div>\n\n  <br class="clear"/>\n\n</form>\n');
window.JST.featured_reporting=_.template('\n<div class="controls actions">\n  <div class="toAdmin minibutton" href="#">Admin Dashboard</div>\n  <div class="reload minibutton" href="#">Reload</div>\n  <div class="add minibutton" href="#">Add</div>\n</div>\n\n<br class="clear"/>\n\n<div class="listing">\n\n</div>\n');window.JST.statistics=_.template('<table>\n  <thead></thead>\n  <tbody>\n\n    \x3c!-- Big Numbers --\x3e\n\n    <tr class="data">\n      <td width="25%"><div class="number"><%= total_documents %></div></td>\n      <td width="25%"><div class="number"><%= private_docs %></div></td>\n      <td width="25%"><div class="number"><%= total_pages %></div></td>\n      <td width="25%"><div class="number"><%= average_page_count %></div></td>\n    </tr>\n    <tr class="labels">\n      <td>Total Documents</td>\n      <td>Private Documents</td>\n      <td>Total Pages</td>\n      <td>Average Pages / Document</td>\n    </tr>\n\n    <tr class="data">\n      <td width="25%"><div class="number"><%= public_docs %></div></td>\n      <td width="25%"><div class="number"><%= embedded_documents %></div></td>\n      <td width="25%"><div class="number"><%= pending_docs %></div></td>\n      <td width="25%"><div class="number"><%= error_docs %></div></td>\n    </tr>\n    <tr class="labels">\n      <td>Public Documents</td>\n      <td>Published Documents</td>\n      <td>Pending Documents</td>\n      <td>Failed or Broken Documents</td>\n    </tr>\n\n    <tr class="data">\n      <td width="25%"><div class="number"><%= remote_url_hits_last_week %></div></td>\n      <td width="25%"><div class="number"><%= remote_url_hits_all_time %></div></td>\n      <td width="25%"><div class="number"><%= count_organizations_embedding %></div></td>\n      <td width="25%"><div class="number"><%= count_total_collaborators %></div></td>\n    </tr>\n    <tr class="labels">\n      <td>Hits on published documents - past week</td>\n      <td>Hits on published documents - all time</td>\n      <td>Organizations Embedding Documents</td>\n      <td>Collaborators on Documents</td>\n    </tr>\n    \n    \x3c!-- Document and Page Charts --\x3e\n\n    <tr class="data">\n      <td colspan="2">\n        <div class="chart_col">\n          <div id="daily_docs_chart" class="chart"></div>\n        </div>\n      </td>\n      <td colspan="2">\n        <div class="chart_col">\n          <div id="weekly_docs_chart" class="chart"></div>\n        </div>\n      </td>\n    </tr>\n    <tr class="labels">\n      <td colspan="2">This Month: <b>Daily</b> Documents &amp; Pages</td>\n      <td colspan="2">All Time: <b>Weekly</b> Documents &amp; Pages</td>\n    </tr>\n    \n    \x3c!-- Hit Charts --\x3e\n    <tr class="data">\n      <td colspan="2">\n        <div class="chart_col">\n          <div id="daily_hits_chart" class="chart"></div>\n        </div>\n      </td>\n      <td colspan="2">\n        <div class="chart_col">\n          <div id="weekly_hits_chart" class="chart"></div>\n        </div>\n      </td>\n    </tr>\n    <tr class="labels">\n      <td colspan="2">This Month: <b>Daily</b> Hits on Published Documents</td>\n      <td colspan="2">All Time: <b>Weekly</b> Hits on Published Documents</td>\n    </tr>\n    \n    \x3c!-- Recent 5 docs --\x3e\n\n    <tr class="data">\n      <td colspan="4">\n        <table class="documents">\n          <thead>\n            <td>Cover</td>\n            <td>ID</td>\n            <td>Title</td>\n            <td>Contributor</td>\n            <td>Organization</td>\n            <td>Pages</td>\n            <td></td>\n          </thead>\n          <tbody>\n            <% _.each(Documents.models.reverse(), function(doc) { %>\n              <tr>\n                <td class="first"><img class="doc" src="<%= doc.get(\'thumbnail_url\') %>" /></td>\n                <td><%= doc.get(\'id\') %></td>\n                <td><%= doc.get(\'public\') ? dc.inflector.truncate(doc.get(\'title\') || \'\', 50) : \'<i>private</i>\' %></td>\n                <td><%= doc.get(\'account_name\') %></td>\n                <td><%= doc.get(\'organization_name\') %></td>\n                <td><%= doc.get(\'page_count\') %></td>\n                <td class="last"></td>\n              </tr>\n            <% }); %>\n          </tbody>\n        </table>\n      </td>\n    </tr>\n    <tr class="labels">\n      <td colspan="4">Most Recent 5 Uploaded Documents</td>\n    </tr>\n    \n    \x3c!-- Popular Docs --\x3e\n\n    <%= JST[\'top_documents\']({}) %>\n    <tr class="labels top_documents_label_week">\n      <td colspan="4">\n        <div class="float_right more_top_documents text_link">All Published Documents</div>\n        <a class="float_right download_csv text_link" href="/admin/top_documents_csv.csv">Download CSV</a></div>\n        Top 5 Most Popular Published Documents - Past 7 days\n      </td>\n    </tr>\n    <tr class="labels top_documents_label_year">\n      <td colspan="4">\n        Most Popular Published Documents - Past year\n      </td>\n    </tr>\n    \n    \x3c!-- Popular Notes --\x3e\n\n    <%= JST[\'top_notes\']({}) %>\n    <tr class="labels top_notes_label_week">\n      <td colspan="4">\n        Top 5 Most Popular Published Notes - Past 7 days\n      </td>\n    </tr>\n    \n    \x3c!-- Popular Notes --\x3e\n\n    <%= JST[\'top_searches\']({}) %>\n    <tr class="labels top_searches_label_week">\n      <td colspan="4">\n        Top 5 Most Popular Search Embeds - Past 7 days\n      </td>\n    </tr>\n    \n    \x3c!-- Breakdown by the numbers --\x3e\n    \n    <tr class="data">\n      <td colspan="4">\n        <table id="numbers">\n          <thead>\n            <td>Model</td>\n            <td>Past Day</td>\n            <td>Past Week</td>\n            <td>Past Month</td>\n            <td>Past 6 Months</td>\n            <td>Total</td>\n            <td></td>\n          </thead>\n          <tbody>\n            <% _.each(stats.numbers, function(numbers, model) { %>\n              <tr>\n                <td class="first"><%= model %></td>\n                <td><%= numbers.day %></td>\n                <td><%= numbers.week %></td>\n                <td><%= numbers.month %></td>\n                <td><%= numbers.half_year %></td>\n                <td><%= numbers.total %></td>\n                <td class="last"></td>\n              </tr>\n            <% }); %>\n          </tbody>\n        </table>\n      </td>\n    </tr>\n    <tr class="labels">\n      <td colspan="5">Breakdown by the Numbers</td>\n    </tr>\n    \n    \x3c!-- EC2 Instances --\x3e\n\n    <tr class="data">\n      <td colspan="4">\n        <table id="instances">\n          <thead>\n            <td>Instance Type</td>\n            <td>Tag</td>\n            <td>ID</td>\n            <td>State</td>\n            <td>DNS (External)</td>\n            <td>DNS (Internal)</td>\n            <td></td>\n          </thead>\n          <tbody>\n            <tr><td colspan="4">CURRENTLY DISABLED (see \n              <a href="https://github.com/documentcloud/documentcloud/blob/master/app/controllers/admin_controller.rb">app/controllers/admin_controller.rb</a>, \n              <a href="https://github.com/documentcloud/documentcloud/blob/master/public/javascripts/admin/admin.js">public/javascripts/admin/admin.js</a>, and \n              <a href="https://github.com/documentcloud/documentcloud/blob/master/app/views/admin/index.html.erb">app/views/admin/index.html.erb</a>)</td></tr>\n            \n            <% _.each(stats.instances, function(instance) { %>\n              <% var id = instance.aws_instance_id; %>\n              <tr>\n                <td><%= instance.aws_instance_type %></td>\n                <td><%= instance_tags[id] || \'<div class="icon minus" data-id="\' + id + \'"></div>\' %></td>\n                <td><%= id %></td>\n                <td><%= instance.aws_state %></td>\n                <td><%= instance.dns_name %></td>\n                <td><%= instance.private_dns_name %></td>\n                <td class="last"></td>\n              </tr>\n            <% }); %>\n          </tbody>\n        </table>\n      </td>\n    </tr>\n    <tr class="labels">\n      <td colspan="4">Active EC2 Instances</td>\n    </tr>\n    \n    \x3c!-- Failed Uploads --\x3e\n\n    <tr class="data">\n      <td colspan="4">\n        <table class="documents">\n          <thead>\n            <td>ID</td>\n            <td>Title</td>\n            <td>Contributor</td>\n            <td>Organization</td>\n            <td>Source</td>\n            <td>Pages</td>\n            <td>Date</td>\n            <td></td>\n          </thead>\n          <tbody>\n            <% _.each(FailedDocuments.models.reverse(), function(doc) { %>\n              <tr>\n                <td class="first">\n                  <a target="_blank" title="open pdf" href="<%= doc.get(\'pdf_url\') %>">\n                    <%= doc.get(\'id\') %>\n                  </a>\n                </td>\n                <td><%= doc.get(\'public\') ? dc.inflector.truncate(doc.get(\'title\') || \'\', 50) : \'<i>private</i>\'  %></td>\n                <td><%= doc.get(\'account_name\') %></td>\n                <td><%= doc.get(\'organization_name\') %></td>\n                <td><%= doc.get(\'public\') ? dc.inflector.truncate(doc.get(\'source\') || \'\', 25) : \'<i>private</i>\'  %></td>\n                <td><%= doc.get(\'page_count\') %></td>\n                <td><%= doc.get(\'created_at\') %></td>\n                <td class="last"></td>\n              </tr>\n            <% }); %>\n          </tbody>\n        </table>\n      </td>\n    </tr>\n    <tr class="labels">\n      <td colspan="4">Most Recent 3 Failed Uploads</td>\n    </tr>\n    \n    \x3c!-- Accounts --\x3e\n\n    <tr class="data accounts_row" style="display:none;">\n      <td colspan="4">\n        <div id="accounts_wrapper">\n        </div>\n      </td>\n    </tr>\n    <tr class="labels accounts_row" style="display:none;">\n      <td colspan="4">\n        <a class="float_right download_csv text_link" href="/admin/accounts_csv.csv">Download CSV</a>\n        All Accounts and Organizations\n      </td>\n    </tr>\n\n  </tbody>\n</table>\n\n<div id="load_all_accounts" class="minibutton float_left">Load All Accounts</div>\n<a class="minibutton download_csv float_left" href="/admin/accounts_csv.csv">Download CSV</a>\n<br class="clear" />');
window.JST.top_documents=_.template("\n<tr class=\"data top_documents_list\">\n  <td colspan=\"4\">\n    <table class=\"documents\">\n      <thead>\n        <td>Cover</td>\n        <td>ID</td>\n        <td>Title</td>\n        <td>Contributor</td>\n        <td>Organization</td>\n        <td>Hits</td>\n        <td>Embed Date</td>\n        <td></td>\n      </thead>\n      <tbody>\n        <% _.each(_.sortBy(TopDocuments.models, function(doc){ return -doc.get('hits')}), function(doc) { %>\n          <tr>\n            <td class=\"first\"><img class=\"doc\" src=\"<%= doc.get('thumbnail_url') %>\" /></td>\n            <td><%= doc.get('document_id') %></td>\n            <td><a href=\"<%= doc.publishedUrl() %>\"><%= doc.get('public') ? dc.inflector.truncate(doc.get('title') || '', 50) : '<i>private</i>' %></a></td>\n            <td><%= doc.get('account_name') %></td>\n            <td><%= doc.get('organization_name') %></td>\n            <td><%= doc.get('hits') %></td>\n            <td><%= doc.get('first_recorded_date') %></td>\n            <td class=\"last\"></td>\n          </tr>\n        <% }); %>\n      </tbody>\n    </table>\n  </td>\n</tr>");
window.JST.top_notes=_.template("\n<tr class=\"data top_notes_list\">\n  <td colspan=\"4\">\n    <table class=\"notes documents\">\n      <thead>\n        <td>Cover</td>\n        <td>ID</td>\n        <td>Title</td>\n        <td>Contributor</td>\n        <td>Organization</td>\n        <td>Hits</td>\n        <td>Embed Date</td>\n        <td></td>\n      </thead>\n      <tbody>\n        <% _.each(_.sortBy(TopNotes.models, function(note){ return -note.get('hits')}), function(note) { %>\n          <tr>\n            <td class=\"first\"><img class=\"doc\" src=\"<%= note.document.get('thumbnail_url') %>\" /></td>\n            <td>\n              <b><%= note.get('id') %></b><br />\n              <%= note.get('document_id') %>\n            </td>\n            <td>\n              <b><a href=\"<%= note.get('url') %>\"><%= dc.inflector.truncate(note.get('title') || '', 50) %></a></b><br />\n              <a href=\"<%= note.document.publishedUrl() %><%= '#document/p' + note.get('page') + '/a' + note.get('id') %>\"><%= note.document.get('access') == dc.access.PUBLIC ? dc.inflector.truncate(note.document.get('title') || '', 50) : '<i>private</i>' %></a>\n            </td>\n            <td><%= note.document.get('account_name') %></td>\n            <td><%= note.document.get('organization_name') %></td>\n            <td>\n              <%= note.get('hits') %>\n            </td>\n            <td><%= note.get('first_recorded_date') %></td>\n            <td class=\"last\"></td>\n          </tr>\n        <% }); %>\n      </tbody>\n    </table>\n  </td>\n</tr>");
window.JST.top_searches=_.template("\n<tr class=\"data top_searches_list\">\n  <td colspan=\"4\">\n    <table class=\"searches\">\n      <thead>\n        <td>Search Query</td>\n        <td>Hits</td>\n        <td>Embed Date</td>\n        <td></td>\n      </thead>\n      <tbody>\n        <% _.each(_.sortBy(TopSearches.models, function(query){ return -query.get('hits')}), function(query) { %>\n          <tr>\n            <td>\n              <b><%= dc.inflector.truncate(query.get('search_query') || '', 80) %></a></b><br />\n              <a href=\"<%= query.get('url') %>\"><%= dc.inflector.truncate(query.get('url') || '', 100) %></a>\n            </td>\n            <td>\n              <%= query.get('hits') %>\n            </td>\n            <td><%= query.get('first_recorded_date') %></td>\n            <td class=\"last\"></td>\n          </tr>\n        <% }); %>\n      </tbody>\n    </table>\n  </td>\n</tr>")})();
