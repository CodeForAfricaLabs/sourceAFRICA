$(function(){window.HomePage=Backbone.View.extend({BLOG_HEADLINES_URL:"//investigativecenters.org/",FAVORITES_URL:"//twitter.com/favorites/AfricanCIR.json?callback=?",el:document.body,events:{"keydown #search_box":"maybeSearch","search #search_box":"search","focus #search_box":"addFocus","blur #search_box":"removeFocus","click .cancel_search":"cancelSearch","click #login_button":"login"},initialize:function(){dc.ui.notifier=new dc.ui.Notifier;this.box=$("#search_box");this.emailInput=$("#account_email");
this.passwordInput=$("#account_password");_.invoke([this.box,this.emailInput,this.passwordInput],"placeholder");$(_.bind(this.loadBlogHeadlines,this))},login:function(){$("#login_form").submit()},search:function(){var b=this.box.val();b&&(window.location=(window.serverRoot||"")+"/public/search/"+encodeURIComponent(b))},cancelSearch:function(){this.box.val("")},maybeSearch:function(b){13==b.which&&this.search()},addFocus:function(){$("#search_box_wrapper").addClass("focus")},removeFocus:function(){$("#search_box_wrapper").removeClass("focus")},
loadTweets:function(){if($(document.body).hasClass("homepage")){var b=DateUtils.create("%b %e, %Y");$.getJSON(this.FAVORITES_URL,function(a){a=a.slice(0,3);var c="";_.each(a,function(a,d){c+=JST["home/tweet"](_.extend(a,{index:d,date:b(new Date(Date.parse(a.created_at)))}))});$("#tweets").html(c).show()})}},loadBlogHeadlines:function(){var b=DateUtils.create("%b %e, %Y");$.getJSON(this.BLOG_HEADLINES_URL,function(a){a=a.posts;if(0<a.length){var c="";_.each(a,function(a,d){c+=JST["home/blog_headline"](_.extend(a,
{date:b(DateUtils.parseRfc(a.date))}))});$("#news_headlines").html(c)}else $("#news").hide()})}});window.homepage=new HomePage});
